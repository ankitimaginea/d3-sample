<!DOCTYPE html>
<html>
<head>
    <title>Click Stream Report</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <meta content="" name="description" />
    <meta content="" name="author" />
    <!--[if IE]>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <![endif]-->

    <link rel="stylesheet" href="app/css/us-heat-map-styles.css">
    <link rel="stylesheet" href="app/css/styles.css">
    <link rel="stylesheet" href="assets/plugins/bootstrap/css/bootstrap.css" />

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

</head>

<body> 
  <!--  navbar -->
  <nav class="navbar navbar-inverse navbar-static-top">
    <div class="container">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="#">Click Stream Report</a>
      </div>
      <div id="navbar" class="navbar-collapse collapse">
        <ul class="nav navbar-nav">
          <li class="active"><a href="#" onclick="toggleView('dailyCount')">Total Count</a></li>
          <li><a href="#" onclick="toggleView('hourlyCount')">Hourly Count</a></li>
        </ul>
      </div><!--/.nav-collapse -->
    </div>
  </nav>  

  <div class="container-fluid">
    <div class="row">
      <div class="col-xs-12 col-sm-9 col-lg-9" style="border:1px solid red">
        <div id="graph-container">

        </div>
        <div id="hourlyCountView" style="display:none" align="center">
          <select name="view" id="hourly-count-view">
            <option class="hourly-count" selected="true">0</option>
            <option class="hourly-count">1</option>
            <option class="hourly-count">2</option>
            <option class="hourly-count">3</option>
            <option class="hourly-count">4</option>
            <option class="hourly-count">5</option>
            <option class="hourly-count">6</option>
            <option class="hourly-count">7</option>
            <option class="hourly-count">8</option>
            <option class="hourly-count">9</option>
            <option class="hourly-count">10</option>
            <option class="hourly-count">11</option>
            <option class="hourly-count">12</option>
            <option class="hourly-count">13</option>
            <option class="hourly-count">14</option>
            <option class="hourly-count">15</option>
            <option class="hourly-count">16</option>
            <option class="hourly-count">17</option>
            <option class="hourly-count">18</option>
            <option class="hourly-count">19</option>
            <option class="hourly-count">20</option>
            <option class="hourly-count">21</option>
            <option class="hourly-count">22</option>
            <option class="hourly-count">23</option>
          </select>
          <button id='prev-btn'>&laquo;Prev</button>
          <button id="play-btn">Play</button>
          <button id='next-btn'>Next&raquo;</button>
        </div>

      </div>
      <div class="col-xs-6 col-sm-3 col-lg-3 hidden-xs" style="border:1px solid red" margin="0">
        <div style="border:1px solid green">
          <h5>UNITED STATES OF AMERICA</h5>
          <h3><span id="totalVisits"></span> &nbsp; Visits</h3>
        </div>
        <div><h6>MOST VISITS</h6></div>
        <div id="state-data">


        </div>
      </div>
    </div>
  </div>

  <script src="data/st.data.js"></script>
  <script src="assets/plugins/jquery-2.0.3.min.js"></script>
  <script src="assets/plugins/bootstrap/js/bootstrap.min.js"></script>
  <script src="lib/d3.min.js"></script>
  <script src="lib/topojson.v1.min.js"></script>
  <script src="app/js/main.js" ></script>
  <script src="app/js/us-heat-map.js"></script>
  <!--[if IE]><script type="text/javascript" src="app/js/excanvas.js"></script><![endif]-->

  <script>
    // handle the resize of the map.
    var width = parseInt(d3.select('#graph-container').style('width'))
    , mapRatio = .5
    , height = width * mapRatio;

    var projection = d3.geo.albersUsa()
        .scale(width)
        .translate([width / 2, height / 2]);

    var path = d3.geo.path()
        .projection(projection);

    var map = d3.select('#graph-container');
    var mapSvg = d3.select("svg");

    //handle the resize of the window
    d3.select(window).on('resize', resizeMap);

    function resizeMap() {
        // adjust as the window size changes
        width = parseInt(map.style('width'));
        height = width * mapRatio;

        // update projection
        projection
            .translate([width / 2, height / 2])
            .scale(width);

        // resize the map svg
        mapSvg
            .style('width', width + 'px')
            .style('height', height + 'px');        
        
        // resize the map
        map.select('.land').attr('d', path);
        map.selectAll('.state').attr('d', path);

    }
  // -resize of map

    function toggleView(view) {

        if (view == 'dailyCount') {
            renderCount(true);

            if(changeDuration){
              window.clearInterval(changeDuration);
              changeDuration = undefined;
              $('#play-btn').text('Play');
            }
        } else {
            renderCount(false);
        }
    }
    
    window.onload = function(){
    		renderCount(true);
        resizeMap();
    };

    function renderCount(daily) {
        if (daily) {
            toggleNode(document.getElementById('hourlyCountView'), false);
            GRAPHZ.start('does-not-matter', true);
        } else {
            toggleNode(document.getElementById('hourlyCountView'), true);
            GRAPHZ.start('does-not-matter');
        }
    }

    function toggleNode(node, display) {
        node.style.display = (display)? 'block':'none';
    }

  </script>

</body>
</html>
